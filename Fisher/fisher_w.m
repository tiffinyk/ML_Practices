function w = fisher_w(c1,c2) 
%利用Fisher准则函数确定最佳投影方向 
%c1和c2分别为两类样本的样本矩阵
%得到样本矩阵的尺寸信息 
%样本矩阵的行数代表样本的维数 
%样本矩阵的列数代表样本的个数 
size1=size(c1); 
size2=size(c2); 
%计算两类样本的均值向量 
m1=sum(c1,2)/size1(2);
m2=sum(c2,2)/size2(2); 
%样本向量减去均值向量 
c1=c1-m1(:,ones(1,size1(2))); 
c2=c2-m2(:,ones(1,size2(2))); 
%计算各类的类内离散度矩阵 
S1=c1*c1.'; 
S2=c2*c2.'; 
%计算总类内离散度矩阵 
Sw=S1+S2; 
%计算最佳投影方向向量 
w=Sw^-1*(m1-m2); 
%将向量长度变成1 
w=w/sqrt(sum(w.^2)); 
end
